<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>คลังไลบรารีโค้ด</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f9ff; /* blue-50 */
        }
        /* Custom scrollbar for pre tags */
        pre::-webkit-scrollbar {
            height: 6px;
        }
        pre::-webkit-scrollbar-track {
            background: #e2e8f0; /* gray-200 */
            border-radius: 10px;
        }
        pre::-webkit-scrollbar-thumb {
            background: #94a3b8; /* slate-400 */
            border-radius: 10px;
        }
        pre::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-600 */
        }

        /* Modal specific styles for animation */
        /* Removed .modal-hidden and .modal-visible as they are no longer explicitly used in JS for opacity/pointer-events */
        /* The transition for opacity will be handled by `transition-opacity` or `transition-all` on the element itself */
        /* The `hidden` Tailwind class handles `display: none` and thus `pointer-events: none` */
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-700 to-blue-900 text-white p-4 shadow-lg">
        <div class="container mx-auto flex items-center justify-between">
            <h1 class="text-3xl font-bold flex items-center gap-3">
                <!-- Library Icon (Inline SVG) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-200">
                    <path d="m16 6 4 14"/><path d="M12 6v14"/><path d="M8 8v12"/><path d="M4 4v16"/>
                </svg>
                คลังไลบรารีโค้ด
            </h1>
            <nav>
                <!-- Optional: Add more navigation links here -->
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex flex-1 container mx-auto p-6 md:p-10 flex-col md:flex-row gap-6">
        <!-- Sidebar for Categories -->
        <aside class="w-full md:w-1/4 bg-white rounded-xl shadow-lg p-5">
            <h2 class="text-2xl font-semibold text-blue-800 mb-5 flex items-center gap-2 border-b pb-3 border-blue-100">
                <!-- Category Icon (Inline SVG) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-600">
                    <path d="M6 15V4a2 2 0 0 1 2-2h4l2 2h5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H7a2 2 0 0 1-1.93-2.5l.8-5a2 2 0 0 1 1.93-1.5H20"/>
                </svg>
                หมวดหมู่
            </h2>
            <nav id="categories-nav">
                <!-- Categories will be dynamically loaded here by JavaScript -->
            </nav>
        </aside>

        <!-- Main Content for Library Items -->
        <section class="flex-1 bg-white rounded-xl shadow-lg p-6">
            <h2 id="current-category-title" class="text-3xl font-bold text-blue-800 mb-7 border-b-2 pb-4 border-blue-200">
                เลือกหมวดหมู่
            </h2>
            <div id="library-items-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Library items will be dynamically loaded here by JavaScript -->
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-blue-700 to-blue-900 text-white p-5 text-center mt-auto shadow-inner">
        <div class="container mx-auto">
            <p class="text-sm">&copy; 2025 คลังไลบรารีโค้ด. สงวนลิขสิทธิ์.</p>
        </div>
    </footer>

    <!-- Library Detail Modal -->
    <div id="library-detail-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300 ease-out">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col transform scale-95 opacity-0 transition-all duration-300 ease-out">
            <div class="flex justify-between items-center p-4 border-b border-gray-200 bg-blue-50">
                <h3 id="modal-title" class="text-2xl font-bold text-blue-800"></h3>
                <button id="modal-close-btn" class="text-gray-500 hover:text-gray-700 p-2 rounded-full hover:bg-gray-200 transition-colors duration-200">
                    <!-- Close Icon (Inline SVG) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
                    </svg>
                </button>
            </div>
            <div class="p-6 overflow-y-auto flex-1">
                <p id="modal-description" class="text-gray-700 mb-4"></p>
                <a id="modal-usage-guide-link" href="#" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline text-base mb-4 inline-flex items-center gap-2 font-medium hidden">
                    <!-- Book Open Icon (Inline SVG) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                    </svg>
                    คู่มือการใช้งาน
                </a>
                <div id="modal-code-section" class="mt-6 bg-gray-100 p-4 rounded-md text-sm font-mono text-gray-800 border border-gray-200 overflow-x-auto hidden">
                    <p class="font-semibold text-gray-700 mb-2 flex items-center justify-between w-full">
                        <span>
                            <!-- Code Icon (Inline SVG) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block align-middle mr-2">
                                <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
                            </svg>
                            โค้ด:
                        </span>
                        <button id="copy-code-btn" class="ml-auto px-3 py-1 bg-blue-500 text-white rounded-md text-xs hover:bg-blue-600 transition-colors duration-200 flex items-center gap-1 shadow-sm">
                            <!-- Copy Icon (Inline SVG) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v2"/>
                            </svg>
                            คัดลอก
                            <span id="copy-feedback" class="text-xs ml-1 hidden"></span>
                        </button>
                    </p>
                    <pre id="modal-code-content" class="whitespace-pre-wrap p-2 bg-gray-50 rounded-md border border-gray-100"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data for library items and categories (simulating a JSON file)
        const libraryData = {
            categories: [
                {
                    id: 'Player',
                    name: 'Player',
                    items: [
                        {
                            id: 'GetPlayerPosition',
                            name: 'GetPlayerPosition',
                            description: 'ฟังชั่นสำหรับ ดึงพิกัดตัวละครผู้เล่นที่อยู่ในเกม\nพิกัดจะถูกคัดลอกให้อัตโนมัติ',
                            usageGuideLink: 'https://www.mongodb.com/docs/drivers/node/current/quick-start/',
                            usageExample: 'GetPlayerPosition():'
                        },
                        {
                            id: 'TeleportPlayer',
                            name: 'TeleportPlayer',
                            description: 'ฟังชั่นสำหรับ ส่งตัวผู้เล่นไปยังพิกัดที่กำหนด',
                            usageGuideLink: 'https://www.mongodb.com/docs/drivers/node/current/quick-start/',
                            usageExample: 'TeleportPlayer(x, y, z)'
                        },
                        {
                            id: 'MovePlayerToPoint',
                            name: 'MovePlayerToPoint',
                            description: 'ฟังชั่นสำหรับ ส่งตัวผู้เล่นค่อยๆเลื่อนไปที่ละนิดไปยังพิกัดที่กำหนด\nสามารถตั้งความเร็วได้',
                            usageGuideLink: 'https://www.mongodb.com/docs/drivers/node/current/quick-start/',
                            usageExample: 'MovePlayerToPoint(x, y, z, speed=0.2)'
                        }
                    ]
                },
                {
                    id: 'Vehicle',
                    name: 'Vehicle',
                    items: [
                        {
                            id: 'SetVehicleHealth',
                            name: 'SetVehicleHealth',
                            description: 'ฟังชั่นสำหรับ เพิ่มเลือดยานพาหนะ',
                            usageGuideLink: 'https://www.mongodb.com/docs/drivers/node/current/quick-start/',
                            usageExample: 'SetVehicleHealth(1000.0):'
                        }
                    ]
                },
                {
                    id: 'Hackgame',
                    name: 'Hackgame',
                    items: [
 
                    ]
                },
                {
                    id: 'SynapseX',
                    name: 'SynapseX',
                    items: [
                        {
                            id: 'SynapseX',
                            name: 'SynapseX Service',
                            description: 'โปรแกรมสำหรับเขียนโปรหรือรันสคริปต่างๆ สำหรับ Creator ทั่วไป',
                            usageGuideLink: 'https://www.mongodb.com/docs/drivers/node/current/quick-start/'
                        }
                    ]
                }
            ]
        };

        let currentSelectedCategory = libraryData.categories[0].id; // Default selected category

        // Get modal elements
        const libraryDetailModal = document.getElementById('library-detail-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalDescription = document.getElementById('modal-description');
        const modalUsageGuideLink = document.getElementById('modal-usage-guide-link');
        const modalCodeSection = document.getElementById('modal-code-section');
        const modalCodeContent = document.getElementById('modal-code-content');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const copyCodeBtn = document.getElementById('copy-code-btn'); // New: Copy button
        const copyFeedback = document.getElementById('copy-feedback'); // New: Copy feedback span

        // Function to show library detail modal
        function showLibraryDetail(item) {
            modalTitle.textContent = item.name;
            modalDescription.textContent = item.description;

            if (item.usageGuideLink) {
                modalUsageGuideLink.href = item.usageGuideLink;
                modalUsageGuideLink.classList.remove('hidden');
            } else {
                modalUsageGuideLink.classList.add('hidden');
            }

            if (item.usageExample) {
                modalCodeContent.textContent = item.usageExample;
                modalCodeSection.classList.remove('hidden');
            } else {
                modalCodeSection.classList.add('hidden');
            }

            // Make the modal container visible (display: flex)
            libraryDetailModal.classList.remove('hidden');

            // Trigger the opacity and transform transitions after a slight delay
            // This delay ensures the 'hidden' class (display: none) is fully removed before transitions start
            setTimeout(() => {
                libraryDetailModal.classList.add('opacity-100'); // Fade in background
                // Animate the inner modal content
                libraryDetailModal.querySelector('div').classList.add('scale-100', 'opacity-100');
                libraryDetailModal.querySelector('div').classList.remove('scale-95', 'opacity-0');
            }, 10); // Small delay
        }

        // Function to hide library detail modal
        function hideLibraryDetail() {
            // Trigger the opacity and transform transitions to hide
            libraryDetailModal.classList.remove('opacity-100'); // Fade out background
            // Animate the inner modal content
            libraryDetailModal.querySelector('div').classList.remove('scale-100', 'opacity-100');
            libraryDetailModal.querySelector('div').classList.add('scale-95', 'opacity-0');

            // Hide the modal container (display: none) after the transition completes
            setTimeout(() => {
                libraryDetailModal.classList.add('hidden');
            }, 300); // Match transition duration
        }

        // Add event listener to close button
        modalCloseBtn.addEventListener('click', hideLibraryDetail);

        // New: Add event listener for copy code button
        copyCodeBtn.addEventListener('click', () => {
            const codeToCopy = modalCodeContent.textContent;
            if (codeToCopy) {
                // Use document.execCommand('copy') for better compatibility in iframes
                const textarea = document.createElement('textarea');
                textarea.value = codeToCopy;
                textarea.style.position = 'fixed'; // Prevent scrolling to bottom
                textarea.style.opacity = 0; // Hide it
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    copyFeedback.textContent = 'คัดลอกแล้ว!';
                    copyFeedback.classList.remove('hidden');
                    setTimeout(() => {
                        copyFeedback.classList.add('hidden');
                        copyFeedback.textContent = '';
                    }, 2000); // Hide feedback after 2 seconds
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                    copyFeedback.textContent = 'คัดลอกไม่ได้!';
                    copyFeedback.classList.remove('hidden');
                    setTimeout(() => {
                        copyFeedback.classList.add('hidden');
                        copyFeedback.textContent = '';
                    }, 2000);
                } finally {
                    document.body.removeChild(textarea);
                }
            }
        });

        // Function to render categories in the sidebar
        function renderCategories() {
            const categoriesNav = document.getElementById('categories-nav');
            categoriesNav.innerHTML = ''; // Clear existing categories

            const ul = document.createElement('ul');
            libraryData.categories.forEach(category => {
                const li = document.createElement('li');
                li.className = 'mb-2';
                const button = document.createElement('button');
                button.className = `block w-full text-left p-3 rounded-lg transition-all duration-200 ease-in-out
                    ${currentSelectedCategory === category.id
                        ? 'bg-blue-100 text-blue-800 font-semibold shadow-inner border border-blue-200'
                        : 'text-gray-700 hover:bg-blue-50 hover:text-blue-700 hover:shadow-sm'
                    }`; // Enhanced button styles
                button.textContent = category.name;
                button.onclick = () => {
                    currentSelectedCategory = category.id;
                    renderCategories(); // Re-render categories to update active state
                    renderLibraryItems(category.id); // Render items for the selected category
                };
                li.appendChild(button);
                ul.appendChild(li);
            });
            categoriesNav.appendChild(ul);
        }

        // Function to render library items for a given category
        function renderLibraryItems(categoryId) {
            const libraryItemsContainer = document.getElementById('library-items-container');
            libraryItemsContainer.innerHTML = ''; // Clear existing items

            const currentCategory = libraryData.categories.find(cat => cat.id === categoryId);
            const currentCategoryTitle = document.getElementById('current-category-title');

            if (currentCategory) {
                currentCategoryTitle.textContent = currentCategory.name;
                if (currentCategory.items.length > 0) {
                    currentCategory.items.forEach(item => {
                        const itemCard = document.createElement('div');
                        itemCard.className = 'bg-blue-50 border border-blue-200 rounded-xl p-6 shadow-md flex flex-col justify-between cursor-pointer transform hover:scale-105 hover:shadow-xl transition-all duration-300 ease-in-out'; // Enhanced card hover effects
                        itemCard.onclick = () => showLibraryDetail(item); // Add click handler to show detail modal

                        let itemContent = `
                            <div>
                                <h3 class="text-xl font-bold text-blue-900 mb-2">${item.name}</h3>
                                <p class="text-gray-700 text-sm mb-4">${item.description}</p>
                        `;

                        // Usage Guide Link (only show if present)
                        if (item.usageGuideLink) {
                            itemContent += `
                                <a href="${item.usageGuideLink}" target="_blank" rel="noopener noreferrer"
                                   class="text-blue-600 hover:underline text-sm mb-2 inline-flex items-center gap-1">
                                    <!-- Book Open Icon (Inline SVG) -->
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block align-middle mr-1">
                                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                                    </svg>
                                    คู่มือการใช้งาน
                                </a>
                            `;
                        }

                        // Usage Example (inline code block - a snippet for the card)
                        if (item.usageExample) {
                             // Display only a short snippet on the card
                            const snippet = item.usageExample.split('\n')[0] + (item.usageExample.split('\n').length > 1 ? '...' : '');
                            itemContent += `
                                <div class="mt-3 bg-gray-100 p-3 rounded-md text-xs font-mono text-gray-800 border border-gray-200 overflow-x-auto">
                                    <p class="font-semibold text-gray-700 mb-1 inline-flex items-center gap-1">
                                        <!-- Code Icon (Inline SVG) -->
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="inline-block align-middle mr-1">
                                            <polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>
                                        </svg>
                                        ตัวอย่าง:
                                    </p>
                                    <pre class="whitespace-pre-wrap">${snippet}</pre>
                                </div>
                            `;
                        }

                        itemContent += `</div>`; // Close the div for item content
                        itemCard.innerHTML = itemContent;
                        libraryItemsContainer.appendChild(itemCard);
                    });
                } else {
                    // Enhanced "No libraries found" message
                    libraryItemsContainer.innerHTML = `
                        <div class="col-span-full text-center py-10 text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="mx-auto mb-4 text-blue-300">
                                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/>
                            </svg>
                            <p class="text-xl font-medium mb-2">ไม่พบไลบรารีในหมวดหมู่นี้</p>
                            <p class="text-md">ลองเลือกหมวดหมู่อื่นๆ หรือเพิ่มไลบรารีใหม่!</p>
                        </div>
                    `;
                }
            } else {
                currentCategoryTitle.textContent = 'ไม่พบหมวดหมู่';
                libraryItemsContainer.innerHTML = '<p class="text-gray-600 col-span-full">กรุณาเลือกหมวดหมู่จากแถบด้านข้าง</p>';
            }
        }

        // Initialize the page on load
        window.onload = function() {
            renderCategories(); // Render categories initially
            renderLibraryItems(currentSelectedCategory); // Render items for the default selected category
        };
    </script>
</body>
</html>
